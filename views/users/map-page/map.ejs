<%- include('../../includes/head.ejs',{_page_title:"Home"})%>
<link rel ="stylesheet" href="/styles/map.css"/>

</head>
<body>
    <%- include('../../includes/header.ejs')%>
    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.0/mapbox-gl-geocoder.min.js'></script>
<link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.0/mapbox-gl-geocoder.css' type='text/css' />
    <main id="map-container">
        <div id="map"></div>
    </main>
    <script>
    
        if ("geolocation" in navigator) { 
            navigator.geolocation.getCurrentPosition(position => { 
                mapboxgl.accessToken = 'pk.eyJ1IjoibWluLWhpZW4iLCJhIjoiY2xuZWt3ODRiMGQyZjJycml4aWNqdzJnOSJ9.gm7kTZ04NHQlKB6IEm7tqQ';
                const map = new mapboxgl.Map({
                container: 'map', // container ID
                // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
                style: 'mapbox://styles/mapbox/streets-v12', // style URL
                center: [position.coords.longitude, position.coords.latitude], // starting position [lng, lat]
                zoom: 12 // starting zoom
                });

                map.addControl(new mapboxgl.NavigationControl(),'bottom-right');
                map.addControl(
                new mapboxgl.GeolocateControl({
                positionOptions: {
                    enableHighAccuracy: true
                },
                // When active the map will receive updates to the device's location as it changes.
                trackUserLocation: true,
                // Draw an arrow next to the location dot to indicate which direction the device is heading.
                showUserHeading: true
            }),'bottom-right');
            map.addControl(
            new MapboxGeocoder({
            accessToken: mapboxgl.accessToken,
            mapboxgl: mapboxgl
            })
            ,'top-left');
            }, position => { 
                mapboxgl.accessToken = 'pk.eyJ1IjoibWluLWhpZW4iLCJhIjoiY2xuZWt3ODRiMGQyZjJycml4aWNqdzJnOSJ9.gm7kTZ04NHQlKB6IEm7tqQ';
                const map = new mapboxgl.Map({
                    container: 'map', // container ID
                    // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
                    style: 'mapbox://styles/mapbox/streets-v12', // style URL
                    center: [107.738113, 15.847219], // starting position [lng, lat]
                    zoom: 3 // starting zoom
                });

                map.addControl(new mapboxgl.NavigationControl(),'bottom-right');
                map.addControl(
                new mapboxgl.GeolocateControl({
                    positionOptions: {
                        enableHighAccuracy: true
                    },
                    // When active the map will receive updates to the device's location as it changes.
                    trackUserLocation: false,
                    // Draw an arrow next to the location dot to indicate which direction the device is heading.
                    showUserHeading: false
                })
                ,'bottom-right');
                map.addControl(
                    new MapboxGeocoder({
                    accessToken: mapboxgl.accessToken,
                    mapboxgl: mapboxgl
                    }) ,'top-left');
            });
        } else { /* geolocation IS NOT available, handle it */ }
        
    </script>
</body>
</html>
